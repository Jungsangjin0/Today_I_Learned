# 영속성 컨텍스트의 특징

- 영속성 컨텍스트와 식별자 값
```
영속성 컨텍스트는 엔티티를 식별자 값(@Id)으로 구분한다. 따라서 영속 상태는 식별자 값이 반드시 있어야 한다.
식별자 값이 없으면 예외가 발생한다.
```

- 영속성 컨텍스트와 데이터베이스 저장
```
영속성 컨텍스트에 저장된 엔티티가 데이터베이스에 저장되는 순간은 JPA는 보통 트랜잭션을 커밋하는 순간
영속성 컨텍스트에 새로 저장된 엔티티를 데이터베이스에 반영한다. 이것을 flush라 한다.
```
 
- 영속성 컨텍스트가 엔티티를 관리하면 다음과 같은 장점이 있다   
    1. 1차 캐시   
    2. 동일성 보장   
    3. 트랜잭션을 지원하는 쓰기 지연   
    4. 변경 감지   
    5. 지연 로딩   


**영속성 컨텍스트가 왜 필요하고 어떤 이점이 있는지 알아보자**


### 엔티티 조회

```
영속성 컨텍스트는 내부에 캐시를 가지고 있는데 이것을 "1차캐시" 라 한다. 영속 상태의 엔티티는 모두 이곳에 저장된다.
간단하게 말해서, 영속성 컨텍스트 내부에 Map이 하나 있는데 키는 @Id로 매핑한 식별자고 값은 entity instance 이다.
```

```java
//비영속
Member member = new Member();
member.setId("1");
member.setUsername("user1");

//영속
em.persist(member);
```

   **1차캐시**
@id|Entity
:----|:-----:|
"1"|member|

##### 출처: 자바 ORM 표준 JPA 프로그래밍
